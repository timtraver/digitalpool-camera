<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Camera Control - Digital Pool</title>
    <link rel="stylesheet" href="style.css" />
  </head>
  <body>
    <div class="container">
      <header>
        <div class="logo-container">
          <img src="images/dp-logo-header.png" alt="DigitalPool" class="logo" />
          <h1>Camera Control</h1>
        </div>
        <div id="connectionStatus" class="status status-disconnected">
          Camera Disconnected
        </div>
      </header>

      <div class="main-content">
        <!-- Video Stream Section -->
        <div class="video-section">
          <div class="video-container">
            <img id="videoStream" src="/video/stream" alt="Camera Stream" />
            <canvas id="overlayCanvas"></canvas>
            <div
              id="previewSourceIndicator"
              style="
                position: absolute;
                top: 10px;
                left: 10px;
                background: rgba(18, 199, 255, 0.9);
                color: white;
                padding: 5px 10px;
                border-radius: 5px;
                font-size: 12px;
                display: none;
                z-index: 100;
              "
            >
              üì° Live Stream Preview
            </div>
          </div>

          <!-- PTZ and Overlay Controls Container -->
          <div class="controls-row">
            <!-- Pan/Tilt Controls -->
            <div class="ptz-controls" style="flex: 0.8">
              <h3>PTZ</h3>
              <div class="control-grid">
                <div class="directional-pad-container">
                  <!-- Outer ring - Large movements -->
                  <button
                    class="btn-control-outer btn-top-outer"
                    id="tiltUpLarge"
                    title="Tilt Up (Large)"
                  >
                    ‚ñ≤
                  </button>
                  <button
                    class="btn-control-outer btn-right-outer"
                    id="panRightLarge"
                    title="Pan Right (Large)"
                  >
                    ‚ñ∫
                  </button>
                  <button
                    class="btn-control-outer btn-bottom-outer"
                    id="tiltDownLarge"
                    title="Tilt Down (Large)"
                  >
                    ‚ñº
                  </button>
                  <button
                    class="btn-control-outer btn-left-outer"
                    id="panLeftLarge"
                    title="Pan Left (Large)"
                  >
                    ‚óÑ
                  </button>

                  <!-- Inner ring - Small movements -->
                  <button
                    class="btn-control-inner btn-top-inner"
                    id="tiltUpSmall"
                    title="Tilt Up (Small)"
                  >
                    ‚ñ≤
                  </button>
                  <button
                    class="btn-control-inner btn-right-inner"
                    id="panRightSmall"
                    title="Pan Right (Small)"
                  >
                    ‚ñ∫
                  </button>
                  <button
                    class="btn-control-inner btn-bottom-inner"
                    id="tiltDownSmall"
                    title="Tilt Down (Small)"
                  >
                    ‚ñº
                  </button>
                  <button
                    class="btn-control-inner btn-left-inner"
                    id="panLeftSmall"
                    title="Pan Left (Small)"
                  >
                    ‚óÑ
                  </button>

                  <!-- Center reset button -->
                  <button
                    class="btn-control-center"
                    id="resetPos"
                    title="Reset Position"
                  >
                    ‚åÇ
                  </button>
                </div>
              </div>
              <div class="speed-info">
                <small>Inner: 0.5¬∞ | Outer: 5¬∞</small>
              </div>

              <!-- Zoom Controls -->
              <div class="ptz-settings" style="margin-top: 10px">
                <div class="control-item-compact">
                  <label for="zoomLevel">Zoom</label>
                  <input
                    type="number"
                    id="zoomLevel"
                    min="0"
                    max="12"
                    value="0"
                    step="1"
                    style="
                      width: 50px;
                      padding: 4px;
                      font-size: 12px;
                      text-align: center;
                    "
                  />
                  <span style="margin-left: 4px; color: #888; font-size: 10px"
                    >(0-12)</span
                  >
                </div>
              </div>
            </div>

            <!-- Overlay Settings -->
            <div class="ptz-controls" style="flex: 1.5">
              <h3>üìù Overlay Settings</h3>
              <div class="overlay-controls">
                <div class="control-item-compact">
                  <label>
                    <input type="checkbox" id="overlayEnabled" />
                    Enable Overlays
                  </label>
                </div>

                <div class="control-item-compact">
                  <label>Overlay Type:</label>
                  <select id="overlayType">
                    <option value="text">Text Overlay</option>
                    <option value="url">URL Overlay (Dynamic)</option>
                  </select>
                </div>

                <!-- Text Overlay Options -->
                <div id="textOverlayOptions">
                  <!-- Timestamp Settings -->
                  <div class="overlay-section">
                    <div class="control-item-compact">
                      <label>
                        <input type="checkbox" id="showTimestamp" />
                        <strong>Timestamp</strong>
                      </label>
                    </div>
                    <div class="control-item-compact">
                      <label>Position:</label>
                      <select id="timestampPosition">
                        <option value="top-left">Top Left</option>
                        <option value="top-center">Top Center</option>
                        <option value="top-right">Top Right</option>
                        <option value="center">Center</option>
                        <option value="bottom-left">Bottom Left</option>
                        <option value="bottom-center">Bottom Center</option>
                        <option value="bottom-right">Bottom Right</option>
                      </select>
                    </div>
                  </div>

                  <!-- Title Text Settings -->
                  <div class="overlay-section">
                    <div class="control-item-compact">
                      <label><strong>Title:</strong></label>
                      <input
                        type="text"
                        id="overlayText"
                        placeholder="Stream Title"
                      />
                    </div>
                    <div class="control-item-compact">
                      <label>Position:</label>
                      <select id="titlePosition">
                        <option value="top-left">Top Left</option>
                        <option value="top-center">Top Center</option>
                        <option value="top-right">Top Right</option>
                        <option value="center">Center</option>
                        <option value="bottom-left">Bottom Left</option>
                        <option value="bottom-center">Bottom Center</option>
                        <option value="bottom-right">Bottom Right</option>
                      </select>
                    </div>
                  </div>

                  <!-- Global Style Settings -->
                  <div class="overlay-section">
                    <div class="control-item-compact">
                      <label>Font Size:</label>
                      <input
                        type="range"
                        id="overlayFontSize"
                        min="16"
                        max="72"
                        value="32"
                      />
                      <span id="fontSizeValue">32px</span>
                    </div>

                    <div class="control-item-compact">
                      <label>Color:</label>
                      <select id="overlayColor">
                        <option value="white">White</option>
                        <option value="black">Black</option>
                        <option value="red">Red</option>
                        <option value="green">Green</option>
                        <option value="blue">Blue</option>
                        <option value="yellow">Yellow</option>
                        <option value="cyan">Cyan</option>
                        <option value="orange">Orange</option>
                      </select>
                    </div>

                    <div class="control-item-compact">
                      <label>Background:</label>
                      <select id="overlayBackground">
                        <option value="transparent">Transparent</option>
                        <option value="semi-black">Semi Black</option>
                        <option value="semi-white">Semi White</option>
                        <option value="black">Solid Black</option>
                        <option value="white">Solid White</option>
                      </select>
                    </div>

                    <div class="control-item-compact">
                      <label>Opacity:</label>
                      <input
                        type="range"
                        id="overlayBackgroundOpacity"
                        min="0"
                        max="100"
                        value="70"
                      />
                      <span id="backgroundOpacityValue">70%</span>
                    </div>
                  </div>
                </div>

                <!-- URL Overlay Options -->
                <div id="urlOverlayOptions" style="display: none">
                  <div class="control-item-compact">
                    <label>URL:</label>
                    <input
                      type="text"
                      id="overlayUrl"
                      placeholder="https://example.com/overlay.html"
                      style="flex: 1"
                    />
                  </div>
                  <div style="padding: 4px 0">
                    <small
                      style="color: rgba(255, 255, 255, 0.6); font-size: 9px"
                      >Loaded via proxy to bypass X-Frame-Options
                      restrictions</small
                    >
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Control Panel Section -->
        <div class="control-panel">
          <h3>Camera Settings</h3>

          <!-- Image Quality Controls -->
          <div class="control-group">
            <h4>Image Quality</h4>

            <div class="control-item">
              <label for="brightness">Brightness</label>
              <input
                type="range"
                id="brightness"
                min="0"
                max="100"
                value="50"
              />
              <span class="value-display" id="brightnessValue">50</span>
            </div>

            <div class="control-item">
              <label for="contrast">Contrast</label>
              <input type="range" id="contrast" min="0" max="100" value="50" />
              <span class="value-display" id="contrastValue">50</span>
            </div>

            <div class="control-item">
              <label for="saturation">Saturation</label>
              <input
                type="range"
                id="saturation"
                min="0"
                max="100"
                value="50"
              />
              <span class="value-display" id="saturationValue">50</span>
            </div>

            <div class="control-item">
              <label for="sharpness">Sharpness</label>
              <input type="range" id="sharpness" min="0" max="100" value="50" />
              <span class="value-display" id="sharpnessValue">50</span>
            </div>
          </div>

          <!-- Exposure Controls -->
          <div class="control-group">
            <h4>Exposure</h4>

            <div class="control-item">
              <label for="exposureAuto">Auto Exposure</label>
              <select id="exposureAuto">
                <option value="0">Auto</option>
                <option value="1">Manual</option>
                <option value="2">Shutter Priority</option>
                <option value="3">Aperture Priority</option>
              </select>
            </div>

            <div class="control-item">
              <label for="exposureAbsolute">Exposure Time</label>
              <input
                type="range"
                id="exposureAbsolute"
                min="1"
                max="2500"
                value="330"
              />
              <span class="value-display" id="exposureAbsoluteValue">330</span>
            </div>

            <div class="control-item">
              <label for="gain">Gain</label>
              <input type="range" id="gain" min="1" max="128" value="1" />
              <span class="value-display" id="gainValue">1</span>
            </div>

            <div class="control-item">
              <label for="backlightCompensation">Backlight Compensation</label>
              <input
                type="range"
                id="backlightCompensation"
                min="0"
                max="18"
                value="9"
              />
              <span class="value-display" id="backlightCompensationValue"
                >9</span
              >
            </div>
          </div>

          <!-- White Balance Controls -->
          <div class="control-group">
            <h4>White Balance</h4>

            <div class="control-item">
              <label for="whiteBalanceAuto">Auto White Balance</label>
              <input type="checkbox" id="whiteBalanceAuto" checked />
            </div>

            <div class="control-item">
              <label for="whiteBalanceTemp">Temperature</label>
              <input
                type="range"
                id="whiteBalanceTemp"
                min="2000"
                max="10000"
                value="5000"
                step="100"
              />
              <span class="value-display" id="whiteBalanceTempValue">5000</span>
            </div>
          </div>

          <!-- Focus Controls -->
          <div class="control-group">
            <h4>Focus</h4>

            <div class="control-item">
              <label for="focusAuto">Auto Focus</label>
              <input type="checkbox" id="focusAuto" checked />
            </div>

            <div class="control-item">
              <label for="focusAbsolute">Focus</label>
              <input
                type="range"
                id="focusAbsolute"
                min="0"
                max="100"
                value="0"
              />
              <span class="value-display" id="focusAbsoluteValue">0</span>
            </div>
          </div>

          <button class="btn-reset" id="resetAll">Reset All Settings</button>

          <!-- Stream Output Controls -->
          <div class="control-group" style="margin-top: 20px">
            <h4>üé• Stream Output</h4>

            <div class="control-item">
              <label>Protocol:</label>
              <select id="streamProtocol">
                <option value="srt">SRT</option>
                <option value="rtmp">RTMP</option>
              </select>
            </div>

            <div class="control-item">
              <label>Destination:</label>
              <input
                type="text"
                id="streamDestination"
                placeholder="srt://server:port"
                style="
                  padding: 5px;
                  border: 1px solid rgba(18, 199, 255, 0.3);
                  border-radius: 5px;
                  background: rgba(6, 16, 27, 0.8);
                  color: rgba(255, 255, 255, 0.85);
                  width: 100%;
                "
              />
            </div>

            <div class="control-item">
              <label>Bitrate:</label>
              <select id="streamBitrate">
                <option value="2000000">2 Mbps</option>
                <option value="5000000" selected>5 Mbps</option>
                <option value="8000000">8 Mbps</option>
                <option value="10000000">10 Mbps</option>
              </select>
            </div>

            <div style="display: flex; gap: 8px; margin-top: 12px">
              <button
                id="startStream"
                class="btn-stream btn-start"
                style="flex: 1"
              >
                ‚ñ∂ Start
              </button>
              <button
                id="stopStream"
                class="btn-stream btn-stop"
                style="flex: 1"
                disabled
              >
                ‚èπ Stop
              </button>
            </div>

            <div
              id="streamStatus"
              style="
                text-align: center;
                padding: 6px;
                background: rgba(6, 16, 27, 0.6);
                border-radius: 4px;
                border: 1px solid rgba(18, 199, 255, 0.2);
                margin-top: 8px;
              "
            >
              <small style="font-size: 10px; color: rgba(255, 255, 255, 0.7)"
                >Status:
                <span
                  id="streamStatusText"
                  style="font-weight: 600; color: rgba(255, 255, 255, 0.9)"
                  >Not streaming</span
                ></small
              >
            </div>
          </div>
        </div>
      </div>

      <footer>
        <p>Digital Pool Camera Control System</p>
      </footer>
    </div>

    <script src="/socket.io/socket.io.js"></script>
    <script src="app.js?v=3"></script>
  </body>
</html>
