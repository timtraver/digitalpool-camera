<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Camera Control - Digital Pool</title>
    <link rel="stylesheet" href="style.css" />
  </head>
  <body>
    <div class="container">
      <header>
        <div class="logo-container">
          <img src="images/dp-logo-header.png" alt="DigitalPool" class="logo" />
          <h1>Camera Control</h1>
        </div>
        <div id="connectionStatus" class="status status-disconnected">
          Camera Disconnected
        </div>
      </header>

      <div class="main-content">
        <!-- Video Stream Section -->
        <div class="video-section">
          <div class="video-container">
            <img id="videoStream" src="/video/stream" alt="Camera Stream" />
            <canvas id="overlayCanvas"></canvas>
          </div>

          <!-- Debug Info -->
          <div
            style="
              padding: 8px;
              background: rgba(0, 0, 0, 0.5);
              margin: 8px 0;
              border-radius: 4px;
              font-size: 11px;
            "
          >
            <div id="debugInfo">
              Canvas: <span id="canvasSize">Not initialized</span>
            </div>
            <button
              id="resizeCanvas"
              style="
                margin-top: 4px;
                padding: 4px 8px;
                font-size: 11px;
                background: #1890ff;
                color: white;
                border: none;
                border-radius: 4px;
                cursor: pointer;
              "
            >
              üîÑ Resize Canvas
            </button>
          </div>

          <!-- PTZ and Stream Controls Container -->
          <div class="controls-row">
            <!-- Pan/Tilt Controls -->
            <div class="ptz-controls">
              <h3>PTZ</h3>
              <div class="control-grid">
                <div class="directional-pad-container">
                  <!-- Outer ring - Large movements -->
                  <button
                    class="btn-control-outer btn-top-outer"
                    id="tiltUpLarge"
                    title="Tilt Up (Large)"
                  >
                    ‚ñ≤
                  </button>
                  <button
                    class="btn-control-outer btn-right-outer"
                    id="panRightLarge"
                    title="Pan Right (Large)"
                  >
                    ‚ñ∫
                  </button>
                  <button
                    class="btn-control-outer btn-bottom-outer"
                    id="tiltDownLarge"
                    title="Tilt Down (Large)"
                  >
                    ‚ñº
                  </button>
                  <button
                    class="btn-control-outer btn-left-outer"
                    id="panLeftLarge"
                    title="Pan Left (Large)"
                  >
                    ‚óÑ
                  </button>

                  <!-- Inner ring - Small movements -->
                  <button
                    class="btn-control-inner btn-top-inner"
                    id="tiltUpSmall"
                    title="Tilt Up (Small)"
                  >
                    ‚ñ≤
                  </button>
                  <button
                    class="btn-control-inner btn-right-inner"
                    id="panRightSmall"
                    title="Pan Right (Small)"
                  >
                    ‚ñ∫
                  </button>
                  <button
                    class="btn-control-inner btn-bottom-inner"
                    id="tiltDownSmall"
                    title="Tilt Down (Small)"
                  >
                    ‚ñº
                  </button>
                  <button
                    class="btn-control-inner btn-left-inner"
                    id="panLeftSmall"
                    title="Pan Left (Small)"
                  >
                    ‚óÑ
                  </button>

                  <!-- Center reset button -->
                  <button
                    class="btn-control-center"
                    id="resetPos"
                    title="Reset Position"
                  >
                    ‚åÇ
                  </button>
                </div>
                <div class="ptz-settings">
                  <div class="control-item-compact">
                    <label for="zoomSlider">Zoom</label>
                    <input
                      type="range"
                      id="zoomSlider"
                      min="0"
                      max="12"
                      value="0"
                      step="1"
                    />
                    <span class="value-display" id="zoomValue">0</span>
                  </div>
                  <div class="speed-info">
                    <small>Inner: 0.5¬∞ | Outer: 5¬∞</small>
                  </div>
                </div>
              </div>
            </div>

            <!-- Streaming Controls -->
            <div class="ptz-controls">
              <h3>üé• Stream Output</h3>
              <div class="stream-controls">
                <div class="control-item-compact">
                  <label>Protocol:</label>
                  <select id="streamProtocol">
                    <option value="srt">SRT</option>
                    <option value="rtmp">RTMP</option>
                  </select>
                </div>

                <div class="control-item-compact">
                  <label>Destination:</label>
                  <input
                    type="text"
                    id="streamDestination"
                    placeholder="srt://server:port"
                  />
                </div>

                <div class="control-item-compact">
                  <label>Bitrate:</label>
                  <select id="streamBitrate">
                    <option value="2000000">2 Mbps</option>
                    <option value="5000000" selected>5 Mbps</option>
                    <option value="8000000">8 Mbps</option>
                    <option value="10000000">10 Mbps</option>
                  </select>
                </div>

                <div class="stream-buttons">
                  <button id="startStream" class="btn-stream btn-start">
                    ‚ñ∂ Start Stream
                  </button>
                  <button id="stopStream" class="btn-stream btn-stop" disabled>
                    ‚èπ Stop Stream
                  </button>
                </div>

                <div id="streamStatus" class="stream-status">
                  <small
                    >Status:
                    <span id="streamStatusText">Not streaming</span></small
                  >
                </div>
              </div>
            </div>
          </div>

          <!-- Overlay Settings (full width below PTZ and Stream) -->
          <div class="overlay-settings-section">
            <details class="overlay-settings" open>
              <summary>üìù Overlay Settings</summary>
              <div class="overlay-controls">
                <div class="control-item-compact">
                  <label>
                    <input type="checkbox" id="overlayEnabled" />
                    Enable Overlays
                  </label>
                </div>

                <div class="control-item-compact">
                  <label>Overlay Type:</label>
                  <select id="overlayType">
                    <option value="text">Text Overlay</option>
                    <option value="url">URL Overlay (Dynamic)</option>
                  </select>
                </div>

                <!-- Text Overlay Options -->
                <div id="textOverlayOptions">
                  <!-- Timestamp Settings -->
                  <div
                    style="
                      border: 1px solid #555;
                      padding: 10px;
                      margin-bottom: 10px;
                      border-radius: 4px;
                      background: rgba(0, 0, 0, 0.2);
                    "
                  >
                    <div class="control-item-compact">
                      <label style="display: flex; align-items: center">
                        <input
                          type="checkbox"
                          id="showTimestamp"
                          style="margin-right: 8px"
                        />
                        <strong>Show Timestamp</strong>
                      </label>
                    </div>
                    <div class="control-item-compact">
                      <label style="min-width: 80px; font-size: 14px"
                        >Position:</label
                      >
                      <select
                        id="timestampPosition"
                        style="
                          flex: 1;
                          padding: 8px;
                          font-size: 14px;
                          min-height: 32px;
                        "
                      >
                        <option value="top-left">Top Left</option>
                        <option value="top-center">Top Center</option>
                        <option value="top-right">Top Right</option>
                        <option value="center">Center</option>
                        <option value="bottom-left">Bottom Left</option>
                        <option value="bottom-center">Bottom Center</option>
                        <option value="bottom-right">Bottom Right</option>
                      </select>
                    </div>
                  </div>

                  <!-- Title Text Settings -->
                  <div
                    style="
                      border: 1px solid #555;
                      padding: 10px;
                      margin-bottom: 10px;
                      border-radius: 4px;
                      background: rgba(0, 0, 0, 0.2);
                    "
                  >
                    <div class="control-item-compact">
                      <label style="min-width: 80px; font-size: 14px"
                        ><strong>Title:</strong></label
                      >
                      <input
                        type="text"
                        id="overlayText"
                        placeholder="Stream Title"
                        style="flex: 1; padding: 8px; font-size: 14px"
                      />
                    </div>
                    <div class="control-item-compact">
                      <label style="min-width: 80px; font-size: 14px"
                        >Position:</label
                      >
                      <select
                        id="titlePosition"
                        style="
                          flex: 1;
                          padding: 8px;
                          font-size: 14px;
                          min-height: 32px;
                        "
                      >
                        <option value="top-left">Top Left</option>
                        <option value="top-center">Top Center</option>
                        <option value="top-right">Top Right</option>
                        <option value="center">Center</option>
                        <option value="bottom-left">Bottom Left</option>
                        <option value="bottom-center">Bottom Center</option>
                        <option value="bottom-right">Bottom Right</option>
                      </select>
                    </div>
                  </div>

                  <!-- Subtitle Text Settings -->
                  <div
                    style="
                      border: 1px solid #555;
                      padding: 10px;
                      margin-bottom: 10px;
                      border-radius: 4px;
                      background: rgba(0, 0, 0, 0.2);
                    "
                  >
                    <div class="control-item-compact">
                      <label style="min-width: 80px; font-size: 14px"
                        ><strong>Subtitle:</strong></label
                      >
                      <input
                        type="text"
                        id="customText2"
                        placeholder="Secondary text"
                        style="flex: 1; padding: 8px; font-size: 14px"
                      />
                    </div>
                    <div class="control-item-compact">
                      <label style="min-width: 80px; font-size: 14px"
                        >Position:</label
                      >
                      <select
                        id="subtitlePosition"
                        style="
                          flex: 1;
                          padding: 8px;
                          font-size: 14px;
                          min-height: 32px;
                        "
                      >
                        <option value="top-left">Top Left</option>
                        <option value="top-center">Top Center</option>
                        <option value="top-right">Top Right</option>
                        <option value="center">Center</option>
                        <option value="bottom-left">Bottom Left</option>
                        <option value="bottom-center">Bottom Center</option>
                        <option value="bottom-right">Bottom Right</option>
                      </select>
                    </div>
                  </div>

                  <!-- Global Style Settings -->
                  <div
                    style="
                      border: 1px solid #555;
                      padding: 10px;
                      border-radius: 4px;
                      background: rgba(0, 0, 0, 0.2);
                    "
                  >
                    <h4 style="margin: 0 0 8px 0; font-size: 13px; color: #aaa">
                      Global Style Settings
                    </h4>

                    <div class="control-item-compact">
                      <label style="min-width: 80px; font-size: 14px"
                        >Font Size:</label
                      >
                      <input
                        type="range"
                        id="overlayFontSize"
                        min="16"
                        max="72"
                        value="32"
                        style="flex: 1"
                      />
                      <span
                        id="fontSizeValue"
                        style="min-width: 50px; text-align: right"
                        >32px</span
                      >
                    </div>

                    <div class="control-item-compact">
                      <label style="min-width: 80px; font-size: 14px"
                        >Text Color:</label
                      >
                      <select
                        id="overlayColor"
                        style="
                          flex: 1;
                          padding: 8px;
                          font-size: 14px;
                          min-height: 32px;
                        "
                      >
                        <option value="white">White</option>
                        <option value="black">Black</option>
                        <option value="red">Red</option>
                        <option value="green">Green</option>
                        <option value="blue">Blue</option>
                        <option value="yellow">Yellow</option>
                        <option value="cyan">Cyan</option>
                        <option value="orange">Orange</option>
                      </select>
                    </div>

                    <div class="control-item-compact">
                      <label style="min-width: 80px; font-size: 14px"
                        >Background:</label
                      >
                      <select
                        id="overlayBackground"
                        style="
                          flex: 1;
                          padding: 8px;
                          font-size: 14px;
                          min-height: 32px;
                        "
                      >
                        <option value="transparent">Transparent</option>
                        <option value="semi-black">
                          Semi-transparent Black
                        </option>
                        <option value="semi-white">
                          Semi-transparent White
                        </option>
                        <option value="black">Solid Black</option>
                        <option value="white">Solid White</option>
                      </select>
                    </div>

                    <div class="control-item-compact">
                      <label style="min-width: 80px; font-size: 14px"
                        >BG Opacity:</label
                      >
                      <input
                        type="range"
                        id="overlayBackgroundOpacity"
                        min="0"
                        max="100"
                        value="70"
                        style="flex: 1"
                      />
                      <span
                        id="backgroundOpacityValue"
                        style="min-width: 50px; text-align: right"
                        >70%</span
                      >
                    </div>
                  </div>
                </div>

                <!-- URL Overlay Options -->
                <div id="urlOverlayOptions" style="display: none">
                  <div class="control-item-compact">
                    <label style="min-width: 80px; font-size: 14px"
                      >Overlay URL:</label
                    >
                    <input
                      type="text"
                      id="overlayUrl"
                      placeholder="https://example.com/overlay.html"
                      style="flex: 1; padding: 8px; font-size: 14px"
                    />
                  </div>
                  <div class="control-item-compact">
                    <small style="color: rgba(255, 255, 255, 0.6)"
                      >URL will be rendered as a browser window with JavaScript
                      support</small
                    >
                  </div>
                </div>

                <div style="display: flex; gap: 8px">
                  <button
                    id="applyOverlay"
                    class="btn-stream btn-start"
                    style="flex: 1"
                  >
                    Apply Overlay
                  </button>
                  <button
                    id="testOverlay"
                    class="btn-stream"
                    style="
                      flex: 0;
                      background: #722ed1;
                      padding: 8px 12px;
                      font-size: 11px;
                    "
                  >
                    üß™ Test
                  </button>
                </div>
              </div>
            </details>
          </div>
        </div>

        <!-- Control Panel Section -->
        <div class="control-panel">
          <h3>Camera Settings</h3>

          <!-- Image Quality Controls -->
          <div class="control-group">
            <h4>Image Quality</h4>

            <div class="control-item">
              <label for="brightness">Brightness</label>
              <input
                type="range"
                id="brightness"
                min="0"
                max="100"
                value="50"
              />
              <span class="value-display" id="brightnessValue">50</span>
            </div>

            <div class="control-item">
              <label for="contrast">Contrast</label>
              <input type="range" id="contrast" min="0" max="100" value="50" />
              <span class="value-display" id="contrastValue">50</span>
            </div>

            <div class="control-item">
              <label for="saturation">Saturation</label>
              <input
                type="range"
                id="saturation"
                min="0"
                max="100"
                value="50"
              />
              <span class="value-display" id="saturationValue">50</span>
            </div>

            <div class="control-item">
              <label for="sharpness">Sharpness</label>
              <input type="range" id="sharpness" min="0" max="100" value="50" />
              <span class="value-display" id="sharpnessValue">50</span>
            </div>
          </div>

          <!-- Exposure Controls -->
          <div class="control-group">
            <h4>Exposure</h4>

            <div class="control-item">
              <label for="exposureAuto">Auto Exposure</label>
              <select id="exposureAuto">
                <option value="0">Auto</option>
                <option value="1">Manual</option>
                <option value="2">Shutter Priority</option>
                <option value="3">Aperture Priority</option>
              </select>
            </div>

            <div class="control-item">
              <label for="exposureAbsolute">Exposure Time</label>
              <input
                type="range"
                id="exposureAbsolute"
                min="1"
                max="2500"
                value="330"
              />
              <span class="value-display" id="exposureAbsoluteValue">330</span>
            </div>

            <div class="control-item">
              <label for="gain">Gain</label>
              <input type="range" id="gain" min="1" max="128" value="1" />
              <span class="value-display" id="gainValue">1</span>
            </div>

            <div class="control-item">
              <label for="backlightCompensation">Backlight Compensation</label>
              <input
                type="range"
                id="backlightCompensation"
                min="0"
                max="18"
                value="9"
              />
              <span class="value-display" id="backlightCompensationValue"
                >9</span
              >
            </div>
          </div>

          <!-- White Balance Controls -->
          <div class="control-group">
            <h4>White Balance</h4>

            <div class="control-item">
              <label for="whiteBalanceAuto">Auto White Balance</label>
              <input type="checkbox" id="whiteBalanceAuto" checked />
            </div>

            <div class="control-item">
              <label for="whiteBalanceTemp">Temperature</label>
              <input
                type="range"
                id="whiteBalanceTemp"
                min="2000"
                max="10000"
                value="5000"
                step="100"
              />
              <span class="value-display" id="whiteBalanceTempValue">5000</span>
            </div>
          </div>

          <!-- Focus Controls -->
          <div class="control-group">
            <h4>Focus</h4>

            <div class="control-item">
              <label for="focusAuto">Auto Focus</label>
              <input type="checkbox" id="focusAuto" checked />
            </div>

            <div class="control-item">
              <label for="focusAbsolute">Focus</label>
              <input
                type="range"
                id="focusAbsolute"
                min="0"
                max="100"
                value="0"
              />
              <span class="value-display" id="focusAbsoluteValue">0</span>
            </div>
          </div>

          <button class="btn-reset" id="resetAll">Reset All Settings</button>
        </div>
      </div>

      <footer>
        <p>Digital Pool Camera Control System</p>
      </footer>
    </div>

    <script src="/socket.io/socket.io.js"></script>
    <script src="app.js"></script>
  </body>
</html>
